# Kaizen Website - AGENTS.md

## Overview

The Kaizen website is a Next.js 16 and TypeScript application that serves as the frontend interface for the Kaizen continuous improvement journal. It consumes `data.json` generated by the kaizen-parser to display a GitHub-style calendar heatmap and chronological timeline of algorithm solutions and system design notes.

**Tech Stack:**
- Next.js 16 (with App Router)
- React 19
- TypeScript 5.9
- Tailwind CSS 4
- Radix UI components
- Framer Motion for animations
- Jest (unit tests) + Playwright (e2e tests)

## Build and Development Commands

### Installation
```bash
npm install          # Install dependencies
npm ci              # Install for CI (frozen lockfile)
```

### Development
```bash
npm run dev         # Start dev server with Turbopack
just dev            # Start dev server with HTTPS (uses --experimental-https)
```

The `predev` script automatically runs `scripts/pre-build.js` before starting the dev server.

### Production Build
```bash
npm run build       # Build for production
just build          # Same as npm run build
```

The `prebuild` script automatically runs `scripts/pre-build.js` before building.

### Testing
```bash
# Unit Tests (Jest)
npm run test        # Run with coverage
just test           # Same as npm run test

# End-to-End Tests (Playwright)
npm run test-e2e    # Run all browsers
just test-e2e       # Build + run all browsers
just test-e2e-on chromium  # Run specific browser
```

The `pretest` script automatically runs `scripts/pre-build.js` before testing.

### Linting and Formatting
```bash
# Linting (ESLint)
npm run lint        # Check for issues
npm run lint:fix    # Auto-fix issues
just lint           # Same as npm run lint

# Formatting (Prettier)
npx prettier . --check   # Check formatting
npx prettier . --write   # Auto-format

# Combined checks
just check          # Run lint + prettier check
just format         # Run lint:fix + prettier write
```

### Docker
```bash
just build-image        # Build Docker image (kaizen-website:dev)
just start-container    # Run container on port 3000
```

### Release Preparation
```bash
just pre-release    # Run checks, tests, and bump version
```

This command:
- Verifies git working directory is clean
- Runs `just check` and `just test`
- Removes `-SNAPSHOT` suffix from version
- Updates `package.json`, `next.config.mjs`, and root `README.md`
- Creates a release commit

## Code Style Guidelines

### ESLint Configuration
- Uses `@eslint/js` and `eslint-config-next`
- Enforces `eslint-config-prettier` for compatibility
- Uses `eslint-plugin-simple-import-sort` for import ordering
- Targets: `src/**/*.{js,jsx,ts,tsx}`

### Prettier Configuration
- Used for consistent code formatting
- Applies to entire project (`.`)

### Import Organization
- Imports are auto-sorted via `eslint-plugin-simple-import-sort`
- Keep imports organized and consistent

## Testing Guidelines

### Unit Tests (Jest)
- Framework: Jest 30 with SWC
- Test environment: jsdom
- Testing utilities: React Testing Library
- Coverage reports are generated automatically
- Test files: `*.test.ts`, `*.test.tsx`
- Location: Typically co-located with source files or in `__tests__` directories

### E2E Tests (Playwright)
- Framework: Playwright
- Browsers: Chromium, Firefox, WebKit
- Coverage reports: Monocart Reporter
- Test files: `*.spec.ts`
- Must build project before running e2e tests
- Clean test results before each run

## Project Structure

```
website/
├── src/                    # Source code
│   ├── app/               # Next.js App Router pages
│   ├── components/        # React components
│   ├── lib/              # Utility functions
│   └── styles/           # Global styles
├── public/               # Static assets
│   └── data.json        # Generated by kaizen-parser
├── scripts/             # Build scripts
│   └── pre-build.js     # Pre-build preparation
├── package.json         # Dependencies and scripts
├── next.config.mjs      # Next.js configuration
├── tailwind.config.ts   # Tailwind CSS configuration
├── jest.config.js       # Jest configuration
├── playwright.config.ts # Playwright configuration
└── justfile            # Just command runner recipes
```

## Key Dependencies

- **UI Components**: Radix UI primitives, Lucide React icons
- **Styling**: Tailwind CSS, class-variance-authority, clsx, tailwind-merge
- **Markdown**: react-markdown, remark-gfm, rehype-raw
- **Charts**: recharts
- **Animations**: framer-motion
- **Forms**: react-hook-form
- **Themes**: next-themes
- **Fonts**: geist

## Development Workflow

1. Make changes to source code
2. Run `just check` to verify linting and formatting
3. Write tests (unit and/or e2e as appropriate)
4. Run `just test` to verify unit tests pass
5. Run `just test-e2e` for critical changes affecting user flows
6. Commit changes following conventional commits (see root AGENTS.md)

## Commit Convention

Follow conventional commits specification with scopes defined in `cliff.toml` at the project root.

Examples:
- `feat(website): add dark mode toggle`
- `fix(website): correct calendar heatmap rendering`
- `test(website): add tests for timeline component`

## Environment Variables

Check `next.config.mjs` for environment-specific configurations and the `APP_VERSION` setting.

## Notes for AI Agents

- Always run pre-build scripts automatically via npm lifecycle hooks
- The project uses Next.js App Router (not Pages Router)
- Respect the existing component structure using Radix UI primitives
- Maintain TypeScript strict mode compliance
- Follow the established pattern of shadcn/ui-style component organization
- The `data.json` file is generated externally by kaizen-parser - do not modify it directly in this project
- Use `just` commands when available for consistency with documented workflow
- Coverage reports are important - maintain or improve test coverage
